<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450" width="800" height="450">
  <defs>
    <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#0d1117"/>
      <stop offset="100%" stop-color="#161b22"/>
    </linearGradient>
    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#21262d" stroke-width="0.5"/>
    </pattern>

    <!-- Forward flow paths (request: →) -->
    <path id="fw1" d="M140,157 L280,157" fill="none"/>
    <path id="fw2" d="M330,157 L470,157" fill="none"/>
    <path id="fw3" d="M520,157 L660,157" fill="none"/>
    <!-- Reverse flow paths (response: ←) -->
    <path id="rv1" d="M280,163 L140,163" fill="none"/>
    <path id="rv2" d="M470,163 L330,163" fill="none"/>
    <path id="rv3" d="M660,163 L520,163" fill="none"/>
  </defs>

  <!-- Background -->
  <rect width="800" height="450" fill="url(#bg)"/>
  <rect width="800" height="450" fill="url(#grid)" opacity="0.3"/>

  <!-- Floating particles -->
  <circle cx="120" cy="60" r="1.5" fill="#8C4FFF" opacity="0.4">
    <animate attributeName="cy" values="60;45;60" dur="4s" repeatCount="indefinite"/>
    <animate attributeName="opacity" values="0.3;0.6;0.3" dur="4s" repeatCount="indefinite"/>
  </circle>
  <circle cx="700" cy="80" r="2" fill="#58a6ff" opacity="0.3">
    <animate attributeName="cy" values="80;95;80" dur="5s" repeatCount="indefinite"/>
    <animate attributeName="opacity" values="0.2;0.5;0.2" dur="5s" repeatCount="indefinite"/>
  </circle>
  <circle cx="720" cy="310" r="1.5" fill="#8C4FFF" opacity="0.3">
    <animate attributeName="cy" values="310;295;310" dur="4.5s" repeatCount="indefinite"/>
    <animate attributeName="opacity" values="0.3;0.5;0.3" dur="4.5s" repeatCount="indefinite"/>
  </circle>
  <circle cx="80" cy="320" r="2" fill="#58a6ff" opacity="0.3">
    <animate attributeName="cy" values="320;335;320" dur="5.5s" repeatCount="indefinite"/>
    <animate attributeName="opacity" values="0.2;0.5;0.2" dur="5.5s" repeatCount="indefinite"/>
  </circle>

  <!-- ===== BIDIRECTIONAL ARROW LINES (↔) ===== -->
  <!-- Upper line (request →) -->
  <line x1="140" y1="157" x2="280" y2="157" stroke="#30363d" stroke-width="1" stroke-dasharray="5,3">
    <animate attributeName="stroke-dashoffset" from="0" to="-8" dur="0.8s" repeatCount="indefinite"/>
  </line>
  <line x1="330" y1="157" x2="470" y2="157" stroke="#30363d" stroke-width="1" stroke-dasharray="5,3">
    <animate attributeName="stroke-dashoffset" from="0" to="-8" dur="0.8s" repeatCount="indefinite"/>
  </line>
  <line x1="520" y1="157" x2="660" y2="157" stroke="#30363d" stroke-width="1" stroke-dasharray="5,3">
    <animate attributeName="stroke-dashoffset" from="0" to="-8" dur="0.8s" repeatCount="indefinite"/>
  </line>
  <!-- Lower line (response ←) -->
  <line x1="280" y1="163" x2="140" y2="163" stroke="#30363d" stroke-width="1" stroke-dasharray="5,3">
    <animate attributeName="stroke-dashoffset" from="0" to="-8" dur="0.8s" repeatCount="indefinite"/>
  </line>
  <line x1="470" y1="163" x2="330" y2="163" stroke="#30363d" stroke-width="1" stroke-dasharray="5,3">
    <animate attributeName="stroke-dashoffset" from="0" to="-8" dur="0.8s" repeatCount="indefinite"/>
  </line>
  <line x1="660" y1="163" x2="520" y2="163" stroke="#30363d" stroke-width="1" stroke-dasharray="5,3">
    <animate attributeName="stroke-dashoffset" from="0" to="-8" dur="0.8s" repeatCount="indefinite"/>
  </line>

  <!-- ===== FORWARD FLOW DOTS (request → purple) ===== -->
  <circle r="3" fill="#8C4FFF" opacity="0.8">
    <animateMotion dur="2s" repeatCount="indefinite"><mpath href="#fw1"/></animateMotion>
  </circle>
  <circle r="3" fill="#8C4FFF" opacity="0.8">
    <animateMotion dur="2s" begin="0.3s" repeatCount="indefinite"><mpath href="#fw2"/></animateMotion>
  </circle>
  <circle r="3" fill="#8C4FFF" opacity="0.8">
    <animateMotion dur="2s" begin="0.6s" repeatCount="indefinite"><mpath href="#fw3"/></animateMotion>
  </circle>

  <!-- ===== REVERSE FLOW DOTS (response ← orange) ===== -->
  <circle r="2.5" fill="#FF9900" opacity="0.7">
    <animateMotion dur="2s" begin="1s" repeatCount="indefinite"><mpath href="#rv1"/></animateMotion>
  </circle>
  <circle r="2.5" fill="#FF9900" opacity="0.7">
    <animateMotion dur="2s" begin="1.3s" repeatCount="indefinite"><mpath href="#rv2"/></animateMotion>
  </circle>
  <circle r="2.5" fill="#FF9900" opacity="0.7">
    <animateMotion dur="2s" begin="1.6s" repeatCount="indefinite"><mpath href="#rv3"/></animateMotion>
  </circle>

  <!-- ===== NODE 1: CloudFront Functions (code brackets) ===== -->
  <g transform="translate(115, 160)">
    <rect x="-25" y="-25" width="50" height="50" rx="12" fill="#161b22" stroke="#8C4FFF" stroke-width="1.5"/>
    <g transform="scale(0.8) translate(-12, -12)">
      <path d="M9 4L3 12l6 8" fill="none" stroke="#8C4FFF" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15 4l6 8-6 8" fill="none" stroke="#8C4FFF" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
      <line x1="13" y1="4" x2="11" y2="20" stroke="#8C4FFF" stroke-width="1.5" stroke-linecap="round" opacity="0.6"/>
    </g>
  </g>

  <!-- ===== NODE 2: CloudFront (globe) ===== -->
  <g transform="translate(305, 160)">
    <rect x="-25" y="-25" width="50" height="50" rx="12" fill="#161b22" stroke="#8C4FFF" stroke-width="1.5"/>
    <g transform="scale(0.8) translate(-12, -12)">
      <circle cx="12" cy="12" r="9" fill="none" stroke="#8C4FFF" stroke-width="2"/>
      <ellipse cx="12" cy="12" rx="4.5" ry="9" fill="none" stroke="#8C4FFF" stroke-width="1.5" opacity="0.6"/>
      <line x1="3" y1="12" x2="21" y2="12" stroke="#8C4FFF" stroke-width="1.5" opacity="0.5"/>
      <line x1="12" y1="3" x2="12" y2="21" stroke="#8C4FFF" stroke-width="1" opacity="0.3"/>
    </g>
  </g>

  <!-- ===== NODE 3: Lambda ===== -->
  <g transform="translate(495, 160)">
    <rect x="-25" y="-25" width="50" height="50" rx="12" fill="#161b22" stroke="#FF9900" stroke-width="1.5"/>
    <g transform="scale(0.8) translate(-12, -12)">
      <path d="M4.9855 0c-.2941.0031-.5335.2466-.534.5482L4.446 5.456c0 .1451.06.2835.159.3891a.5322.5322 0 0 0 .3806.1562h3.4282l8.197 17.6805a.5365.5365 0 0 0 .4885.3181h5.811c.2969 0 .5426-.2448.5426-.5482V18.544c0-.3035-.2392-.5482-.5425-.5482h-2.0138L12.7394.3153C12.647.124 12.4564 0 12.2452 0h-7.254Zm.5397 1.0907h6.3678l8.16 17.6804a.5365.5365 0 0 0 .4885.3181h1.8178v3.8173H17.437L9.2402 5.226a.536.536 0 0 0-.4885-.318H5.5223Zm2.0137 8.2366c-.2098.0011-.3937.1193-.4857.3096L.6002 23.2133a.5506.5506 0 0 0 .0313.5282.5334.5334 0 0 0 .4544.25h6.169a.5468.5468 0 0 0 .497-.3096l3.38-7.166a.5405.5405 0 0 0-.0029-.4686L8.036 9.637a.5468.5468 0 0 0-.4942-.3096Zm.0057 1.8036 2.488 5.1522-3.1214 6.6206H1.9465Z" fill="#FF9900"/>
    </g>
  </g>

  <!-- ===== NODE 4: S3 (bucket) ===== -->
  <g transform="translate(685, 160)">
    <rect x="-25" y="-25" width="50" height="50" rx="12" fill="#161b22" stroke="#569A31" stroke-width="1.5"/>
    <g transform="scale(0.8) translate(-12, -12)">
      <ellipse cx="12" cy="5.5" rx="7" ry="2.8" fill="#569A31" opacity="0.9"/>
      <rect x="5" y="5.5" width="14" height="13" fill="#569A31" opacity="0.5"/>
      <ellipse cx="12" cy="18.5" rx="7" ry="2.8" fill="#569A31" opacity="0.9"/>
      <ellipse cx="12" cy="12" rx="7" ry="2" fill="none" stroke="#161b22" stroke-width="0.8" opacity="0.4"/>
    </g>
  </g>

  <!-- ===== NODE LABELS ===== -->
  <text x="115" y="205" font-family="'Inter', sans-serif" font-size="10" fill="#8b949e" text-anchor="middle">CF Functions</text>
  <text x="305" y="205" font-family="'Inter', sans-serif" font-size="10" fill="#8b949e" text-anchor="middle">CloudFront</text>
  <text x="495" y="205" font-family="'Inter', sans-serif" font-size="10" fill="#8b949e" text-anchor="middle">Lambda</text>
  <text x="685" y="205" font-family="'Inter', sans-serif" font-size="10" fill="#8b949e" text-anchor="middle">S3</text>

  <!-- Title -->
  <text x="400" y="370" font-family="'Inter', -apple-system, BlinkMacSystemFont, sans-serif" font-size="32" font-weight="700" fill="#e6edf3" text-anchor="middle">이미지 최적화</text>

  <!-- Accent line -->
  <line x1="355" y1="388" x2="445" y2="388" stroke="#8C4FFF" stroke-width="2" opacity="0.4" stroke-linecap="round"/>
</svg>
